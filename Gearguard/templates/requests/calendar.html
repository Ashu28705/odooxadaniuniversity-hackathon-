{% extends "layouts/base.html" %}

{% block content %}
<div class="container-fluid">
    
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold mb-0">Maintenance Schedule</h2>
            <p class="text-muted">Track upcoming checkups and repair deadlines</p>
        </div>
        <div>
            <span class="badge bg-primary me-2">ðŸ“… Scheduled Maintenance</span>
            <span class="badge bg-danger">ðŸš¨ Repair Deadlines</span>
        </div>
    </div>

    <div class="card shadow border-0 rounded-4">
        <div class="card-body p-4">
            <div id='calendar'></div>
        </div>
    </div>

</div>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />

<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,listWeek'
            },
            events: '/calendar/events', // <--- Fetches data from app.py
            eventClick: function(info) {
                // Open ticket in new tab when clicked
                if (info.event.url) {
                    window.open(info.event.url, "_self");
                    info.jsEvent.preventDefault();
                }
            },
            height: 650
        });
        calendar.render();
    });
</script>

<style>
    /* Make calendar look modern */
    .fc-event { cursor: pointer; border-radius: 4px; border: none; padding: 2px 4px; }
    .fc-daygrid-day-number { color: #333; font-weight: bold; text-decoration: none; }
    .fc-col-header-cell-cushion { color: #555; text-decoration: none; text-transform: uppercase; font-size: 0.85rem; }
    .fc-button-primary { background-color: #2c3e50 !important; border-color: #2c3e50 !important; }
</style>
{% endblock %}